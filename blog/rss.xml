<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Yap Docs Blog</title>
        <link>https://yapdocs.com/blog</link>
        <description>Yap Docs Blog</description>
        <lastBuildDate>Sat, 24 Aug 2024 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Hacking Yap to Add a PR extension]]></title>
            <link>https://yapdocs.com/blog/pr-extension-hack</link>
            <guid>https://yapdocs.com/blog/pr-extension-hack</guid>
            <pubDate>Sat, 24 Aug 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[You can add a Public Relations or other miscellaneous extensions by doing the following, and leveraging the Menu Options and the Custom Extensions option.]]></description>
            <content:encoded><![CDATA[<p>You can add a Public Relations or other miscellaneous extensions by doing the following, and leveraging the <a href="https://yapdocs.com/general/menu-options/">Menu Options</a> and the <a href="https://yapdocs.com/helpline/custom-extensions/">Custom Extensions</a> option.</p>
<ol>
<li>Update or set a digit map as follows adding a new option.  As see below we added a new option for pressing 3.</li>
</ol>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">static $digit_map_search_type = ['1' =&gt; SearchType::MEETINGS, '2' =&gt; SearchType::VOLUNTEERS, '3' =&gt; SearchType::CUSTOM_EXTENSIONS];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>
<p>You will have to add a voice green recording that states what all the options are because by default the custom extension is a hidden menu option in that the spoken voice feature will not indicate it is there.  You set this by placing an MP3 or WAV file on a webserver and referencing it with <a href="https://yapdocs.com/general/voice-greeting/">this setting</a>.</p>
</li>
<li>
<p>You will create a new setting that indicates what each custom extension is and what phone number it goes to.  For example if you wanted extension 1 to go to 555-555-1212 you would set this as below.</p>
</li>
</ol>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">static $custom_extensions = [1 =&gt; '555-555-1212'];</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>Once that is done you will create another voice recording indicating what each custom extension will route to.  You can include as many as you want.  The important thing to note is that your custom recording should inform the caller to press pound after they enter the extension number.</li>
</ol>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">static $en_US_custom_extensions_greeting = "https://example.org/customext.mp3";</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>formats</category>
            <category>yap</category>
        </item>
        <item>
            <title><![CDATA[Merging Yap Servers]]></title>
            <link>https://yapdocs.com/blog/merging-yap-post</link>
            <guid>https://yapdocs.com/blog/merging-yap-post</guid>
            <pubDate>Sun, 01 Aug 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Since Yap 3.0.0 (released in March 2019), it’s been possible to use a single Yap server with multiple Twilio accounts.  What this means is that a service body can handle the overhead of server management while another service body retains the management of phone numbers and billing.]]></description>
            <content:encoded><![CDATA[<p>Since Yap 3.0.0 (released in March 2019), it’s been possible to use a single Yap server with multiple Twilio accounts.  What this means is that a service body can handle the overhead of server management while another service body retains the management of phone numbers and billing.</p>
<p>Yap 3 also introduced the concept of configuration precedence <a href="https://github.com/bmlt-enabled/yap/wiki/Configuration-Precedence" target="_blank" rel="noopener noreferrer">https://github.com/bmlt-enabled/yap/wiki/Configuration-Precedence</a>.  This creates the ability to manifest all kinds of powerful capability without requiring access to the config.php on the server (critical for this situation where server management is handled by someone else).  It also has the ability to set a value at regional level while the hierarchy of the BMLT automatically cascades down to the member areas.</p>
<p>Recently I had to migrate my regional yap server to the zonal server.  Below is the process I followed, feel free to send an email to <a href="mailto:help@bmlt.app" target="_blank" rel="noopener noreferrer">help@bmlt.app</a> if you’d like more details.</p>
<p>Consider whether you may want to take a backup and overwrite your existing Yap database, or make a copy with a new install and config to do side by side testing.  You may also want to consider setting in the database config ahead of time or afterward.  You may also want to transfer any other settings in your top level config.php to the Config settings in the admin portal.  Keep in mind that service bodies will use the hierarchy, so if you set this as a regional level all the service bodies connected will inherit them.</p>
<ol>
<li>Delete any configuration from the target yap server, use the server body IDs that would be the IDs that would be the query below:</li>
</ol>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">DELETE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">FROM</span><span class="token plain"> config </span><span class="token keyword" style="color:rgb(127, 219, 202)">where</span><span class="token plain"> service_body_id </span><span class="token operator" style="color:rgb(127, 219, 202)">in</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Begin an export from your source yap server, select only data and exclude the flags table.  See the screenshot below.  (Use a self-contained file)</li>
</ol>
<p><img decoding="async" loading="lazy" alt="MySQL Export" src="https://yapdocs.com/assets/images/mysql-export-e5f71a6ce1c368a20c842f3ab6a8bca5.png" width="618" height="656" class="img_ev3q"></p>
<ol start="3">
<li>After the file has been exported run the below on your system.  In the below example, “export.sql” is the file exported from Step 2 above.</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token plain">cat export.sql | sed -e “s/([0-9]*,/(NULL,/g” &gt; export-mod.sql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="4">
<li>
<p>Import export-mod.sql into the target yap server.  “export-mod.sql” is the output from the command run locally in Step 3 above.</p>
</li>
<li>
<p>Your phone numbers must have explicit service body overrides in order to pull configuration values from the database (you can use either override_service_body_id or override_service_body_config_id).  One changes your service body for call routing and the other selects configuration, respectively.</p>
</li>
</ol>]]></content:encoded>
            <category>yap</category>
        </item>
        <item>
            <title><![CDATA[Excluding a custom format from a Yap query]]></title>
            <link>https://yapdocs.com/blog/excluding-format-post</link>
            <guid>https://yapdocs.com/blog/excluding-format-post</guid>
            <pubDate>Tue, 28 May 2019 00:00:00 GMT</pubDate>
            <description><![CDATA[It’s possible to exclude a result from Yap results by using a custom format. For example say you made a Temporary Closure format that had an ID of 2069. You could set in your config.php a custom query, which would exclude those in the response.]]></description>
            <content:encoded><![CDATA[<p>It’s possible to exclude a result from Yap results by using a custom format. For example say you made a Temporary Closure format that had an ID of 2069. You could set in your <code>config.php</code> a custom query, which would exclude those in the response.</p>]]></content:encoded>
            <category>formats</category>
            <category>yap</category>
        </item>
    </channel>
</rss>