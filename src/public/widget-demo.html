<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yap WebRTC Dial Widget Demo</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 10px;
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.9);
            text-align: center;
            margin-bottom: 40px;
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .demo-section {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .demo-section h2 {
            margin-top: 0;
            color: #333;
            font-size: 1.25rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .widget-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.5;
        }

        .code-block .comment {
            color: #6a9955;
        }

        .code-block .tag {
            color: #569cd6;
        }

        .code-block .attr {
            color: #9cdcfe;
        }

        .code-block .string {
            color: #ce9178;
        }

        .info-box {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
        }

        .info-box h3 {
            margin: 0 0 10px 0;
            color: #0369a1;
            font-size: 1rem;
        }

        .info-box ul {
            margin: 0;
            padding-left: 20px;
            color: #0c4a6e;
        }

        .info-box li {
            margin: 5px 0;
        }

        .warning-box {
            background: #fffbeb;
            border: 1px solid #fcd34d;
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
        }

        .warning-box h3 {
            margin: 0 0 10px 0;
            color: #b45309;
            font-size: 1rem;
        }

        .warning-box p {
            margin: 0;
            color: #92400e;
        }

        .footer {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            padding: 20px;
        }

        .footer a {
            color: white;
        }

        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Yap WebRTC Dial Widget</h1>
        <p class="subtitle">Enable browser-based calling on your website</p>

        <div class="demo-grid">
            <!-- Live Demo -->
            <div class="demo-section">
                <h2>Live Demo</h2>
                <div class="widget-container">
                    <!-- Widget with data attributes (auto-initialized) -->
                    <div
                        id="demo-widget"
                        data-yap-widget
                        data-yap-api-url=""
                        data-yap-title="NA Helpline"
                        data-yap-show-location="true"
                    ></div>
                </div>

                <div class="warning-box">
                    <h3>Configuration Required</h3>
                    <p>
                        This demo requires WebRTC to be enabled in your Yap configuration.
                        Add the following settings to your config.php:
                    </p>
                    <div class="code-block" style="margin-top: 10px;">
<span class="attr">$webrtc_enabled</span> = <span class="string">true</span>;
<span class="attr">$twilio_api_key</span> = <span class="string">'SKxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>;
<span class="attr">$twilio_api_secret</span> = <span class="string">'your_api_secret'</span>;
<span class="attr">$twilio_twiml_app_sid</span> = <span class="string">'APxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>;
                    </div>
                </div>
            </div>

            <!-- Simple Embed -->
            <div class="demo-section">
                <h2>Simple Embed (Data Attributes)</h2>
                <p>The easiest way to add the widget to your site:</p>

                <div class="code-block">
<span class="comment">&lt;!-- Add the widget container --&gt;</span>
<span class="tag">&lt;div</span>
    <span class="attr">data-yap-widget</span>
    <span class="attr">data-yap-api-url</span>=<span class="string">"https://your-yap-server.com"</span>
    <span class="attr">data-yap-title</span>=<span class="string">"NA Helpline"</span>
<span class="tag">&gt;&lt;/div&gt;</span>

<span class="comment">&lt;!-- Load the widget script --&gt;</span>
<span class="tag">&lt;script</span> <span class="attr">src</span>=<span class="string">"https://your-yap-server.com/widget-loader.js"</span><span class="tag">&gt;&lt;/script&gt;</span>
                </div>

                <div class="info-box">
                    <h3>Available Data Attributes</h3>
                    <ul>
                        <li><code>data-yap-api-url</code> - Your Yap server URL (required)</li>
                        <li><code>data-yap-service-body</code> - Service body ID to route calls</li>
                        <li><code>data-yap-title</code> - Custom widget title</li>
                        <li><code>data-yap-show-location</code> - Show location input (true/false)</li>
                        <li><code>data-yap-show-search-type</code> - Show search type selector (true/false)</li>
                        <li><code>data-yap-search-type</code> - Default: helpline, meeting, jft, spad</li>
                    </ul>
                </div>
            </div>

            <!-- Programmatic Usage -->
            <div class="demo-section">
                <h2>Programmatic Initialization</h2>
                <p>For more control, initialize the widget with JavaScript:</p>

                <div class="code-block">
<span class="tag">&lt;div</span> <span class="attr">id</span>=<span class="string">"my-widget"</span><span class="tag">&gt;&lt;/div&gt;</span>

<span class="tag">&lt;script</span> <span class="attr">src</span>=<span class="string">"https://your-yap-server.com/widget-loader.js"</span><span class="tag">&gt;&lt;/script&gt;</span>
<span class="tag">&lt;script&gt;</span>
YapWidget.load({
    container: <span class="string">'#my-widget'</span>,
    apiUrl: <span class="string">'https://your-yap-server.com'</span>,
    serviceBodyId: <span class="string">'123'</span>,
    title: <span class="string">'NA Helpline'</span>,
    showLocationInput: <span class="string">true</span>,
    showSearchType: <span class="string">false</span>,
    onCallStart: <span class="string">function</span>() {
        console.log(<span class="string">'Call started'</span>);
    },
    onCallEnd: <span class="string">function</span>(data) {
        console.log(<span class="string">'Call ended'</span>, data);
    },
    onError: <span class="string">function</span>(error) {
        console.error(<span class="string">'Call error'</span>, error);
    }
});
<span class="tag">&lt;/script&gt;</span>
                </div>
            </div>

            <!-- Custom Styling -->
            <div class="demo-section">
                <h2>Custom Styling</h2>
                <p>Override the default styles to match your site:</p>

                <div class="code-block">
YapWidget.load({
    container: <span class="string">'#my-widget'</span>,
    apiUrl: <span class="string">'https://your-yap-server.com'</span>,
    styles: {
        container: {
            backgroundColor: <span class="string">'#f5f5f5'</span>,
            borderRadius: <span class="string">'20px'</span>,
            boxShadow: <span class="string">'none'</span>
        },
        callButton: {
            backgroundColor: <span class="string">'#1976d2'</span>
        },
        title: {
            color: <span class="string">'#1976d2'</span>
        }
    }
});
                </div>
            </div>
        </div>

        <!-- Setup Instructions -->
        <div class="demo-section">
            <h2>Twilio Setup Instructions</h2>
            <p>To enable WebRTC calling, you need to configure a few things in Twilio:</p>

            <ol style="color: #333; line-height: 2;">
                <li>
                    <strong>Create an API Key:</strong>
                    Go to Twilio Console &rarr; Account &rarr; API keys &rarr; Create API Key.
                    Save the SID and Secret.
                </li>
                <li>
                    <strong>Create a TwiML Application:</strong>
                    Go to Twilio Console &rarr; Voice &rarr; TwiML Apps &rarr; Create new TwiML App.
                    <ul>
                        <li>Set the Voice Request URL to: <code>https://your-yap-server.com/webrtc-call</code></li>
                        <li>Set the Status Callback URL to: <code>https://your-yap-server.com/webrtc-status</code></li>
                        <li>Save the Application SID</li>
                    </ul>
                </li>
                <li>
                    <strong>Add settings to your Yap config.php:</strong>
                    <div class="code-block" style="margin: 10px 0;">
$webrtc_enabled = true;
$twilio_api_key = 'SKxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';
$twilio_api_secret = 'your_api_secret_here';
$twilio_twiml_app_sid = 'APxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx';
                    </div>
                </li>
                <li>
                    <strong>Test the widget:</strong>
                    Visit this demo page and try making a call!
                </li>
            </ol>
        </div>

        <div class="footer">
            <p>
                Yap WebRTC Dial Widget |
                <a href="https://github.com/bmlt-enabled/yap" target="_blank">GitHub</a> |
                <a href="https://yap.bmlt.app" target="_blank">Documentation</a>
            </p>
        </div>
    </div>

    <!-- Load the widget -->
    <script>
        // Set the API URL dynamically based on current location
        document.addEventListener('DOMContentLoaded', function() {
            var widget = document.getElementById('demo-widget');
            if (widget) {
                widget.setAttribute('data-yap-api-url', window.location.origin);
            }
        });
    </script>
    <script src="widget-loader.js"></script>
</body>
</html>
